<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - ProjectDock</title>
    <meta name="description" content="View your project analytics and statistics">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <span class="nav-logo" id="nav-logo">
                    <svg class="dock-icon" width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect class="dock-base" x="2" y="20" width="28" height="10" rx="2" fill="url(#dockGradient)"/>
                        <rect class="project-box box-1" x="6" y="12" width="6" height="6" rx="1" fill="url(#boxGradient1)"/>
                        <rect class="project-box box-2" x="13" y="10" width="6" height="6" rx="1" fill="url(#boxGradient2)"/>
                        <rect class="project-box box-3" x="20" y="14" width="6" height="6" rx="1" fill="url(#boxGradient3)"/>
                        <rect x="4" y="24" width="2" height="6" fill="url(#dockGradient)"/>
                        <rect x="12" y="24" width="2" height="6" fill="url(#dockGradient)"/>
                        <rect x="20" y="24" width="2" height="6" fill="url(#dockGradient)"/>
                        <rect x="26" y="24" width="2" height="6" fill="url(#dockGradient)"/>
                        <defs>
                            <linearGradient id="dockGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="boxGradient1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="boxGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="boxGradient3" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#43e97b;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#38f9d7;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                </span>
                <span class="nav-brand-text">ProjectDock</span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Home</a></li>
                <li><a href="projects.html" class="nav-link">Projects</a></li>
                <li><a href="add-project.html" class="nav-link">Add Project</a></li>
                <li><a href="categories.html" class="nav-link">Categories</a></li>
                <li><a href="dashboard.html" class="nav-link active">Dashboard</a></li>
                <li><a href="about.html" class="nav-link">About</a></li>
                <li><a href="contact.html" class="nav-link">Contact</a></li>
            </ul>
            <button class="theme-toggle" aria-label="Toggle theme">
                <span>ðŸŒ™</span>
            </button>
            <button class="hamburger" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Page Header -->
    <section style="background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end)); padding: 8rem 1.5rem 4rem; margin-top: 70px;">
        <div class="container">
            <h1 class="text-center" style="color: white; margin-bottom: 1rem;">Dashboard</h1>
            <p class="text-center" style="color: rgba(255,255,255,0.9); max-width: 600px; margin: 0 auto;">Your project analytics and overview</p>
        </div>
    </section>

    <!-- Quick Stats -->
    <section class="container" style="padding: 4rem 1.5rem;">
        <div class="stats-container">
            <div class="stat-card fade-on-scroll">
                <div class="stat-number" data-target="0" id="total-projects">0</div>
                <div class="stat-label">Total Projects</div>
            </div>
            <div class="stat-card fade-on-scroll">
                <div class="stat-number" data-target="0" id="completed-count">0</div>
                <div class="stat-label">Completed</div>
            </div>
            <div class="stat-card fade-on-scroll">
                <div class="stat-number" data-target="0" id="in-progress-count">0</div>
                <div class="stat-label">In Progress</div>
            </div>
            <div class="stat-card fade-on-scroll">
                <div class="stat-number" data-target="0" id="categories-count">0</div>
                <div class="stat-label">Categories</div>
            </div>
        </div>
    </section>

    <!-- Charts Section -->
    <section class="container" style="padding: 0 1.5rem 4rem;">
        <div class="grid grid-2" style="gap: 2rem;">
            <!-- Status Chart -->
            <div class="card fade-on-scroll">
                <h3 style="margin-bottom: 1.5rem;">Projects by Status</h3>
                <div id="status-chart" style="min-height: 300px;">
                    <!-- Chart will be rendered here -->
                </div>
            </div>

            <!-- Category Chart -->
            <div class="card fade-on-scroll">
                <h3 style="margin-bottom: 1.5rem;">Projects by Category</h3>
                <div id="category-chart" style="min-height: 300px;">
                    <!-- Chart will be rendered here -->
                </div>
            </div>
        </div>
    </section>

    <!-- Status Overview -->
    <section class="container" style="padding: 0 1.5rem 4rem;">
        <h2 class="mb-lg fade-on-scroll">Project Status Overview</h2>
        <div class="grid grid-3">
            <div class="card fade-on-scroll">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h4>Completed</h4>
                    <span style="font-size: 2rem; font-weight: 700; color: #48bb78;" id="completed-percentage">0%</span>
                </div>
                <div style="width: 100%; height: 12px; background: var(--border-color); border-radius: var(--radius-sm); overflow: hidden;">
                    <div id="completed-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #48bb78, #38a169); transition: width 1s ease;"></div>
                </div>
            </div>
            <div class="card fade-on-scroll">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h4>In Progress</h4>
                    <span style="font-size: 2rem; font-weight: 700; color: #4299e1;" id="in-progress-percentage">0%</span>
                </div>
                <div style="width: 100%; height: 12px; background: var(--border-color); border-radius: var(--radius-sm); overflow: hidden;">
                    <div id="in-progress-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #4299e1, #3182ce); transition: width 1s ease;"></div>
                </div>
            </div>
            <div class="card fade-on-scroll">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem;">
                    <h4>Planned</h4>
                    <span style="font-size: 2rem; font-weight: 700; color: #ed8936;" id="planned-percentage">0%</span>
                </div>
                <div style="width: 100%; height: 12px; background: var(--border-color); border-radius: var(--radius-sm); overflow: hidden;">
                    <div id="planned-bar" style="width: 0%; height: 100%; background: linear-gradient(90deg, #ed8936, #dd6b20); transition: width 1s ease;"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Recent Activity -->
    <section class="container" style="padding: 0 1.5rem 4rem;">
        <h2 class="mb-lg fade-on-scroll">Recent Projects</h2>
        <div class="card fade-on-scroll">
            <div id="recent-projects-list">
                <!-- Recent projects will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Quick Actions -->
    <section class="container" style="padding: 0 1.5rem 4rem;">
        <h2 class="mb-lg fade-on-scroll">Quick Actions</h2>
        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
            <a href="add-project.html" class="btn btn-secondary">âž• Add New Project</a>
            <a href="projects.html" class="btn btn-secondary">ðŸ“‹ View All Projects</a>
            <a href="categories.html" class="btn btn-secondary">ðŸ“‚ Browse Categories</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>ProjectDock</h4>
                    <p>Organize, showcase, and track your projects with ease.</p>
                </div>
                <div class="footer-section">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="projects.html">Projects</a></li>
                        <li><a href="add-project.html">Add Project</a></li>
                        <li><a href="dashboard.html">Dashboard</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Resources</h4>
                    <ul>
                        <li><a href="categories.html">Categories</a></li>
                        <li><a href="about.html">About</a></li>
                        <li><a href="contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ProjectDock. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="js/app.js"></script>
    <script>
        function loadDashboard() {
            let projects = ProjectDock.ProjectStorage.getProjects();
            if (!Array.isArray(projects)) {
                console.error('Projects data is not an array:', projects);
                projects = [];
            }
            
            // Calculate statistics
            const total = projects.length;
            const completed = projects.filter(p => p.status === 'Completed').length;
            const inProgress = projects.filter(p => p.status === 'In Progress').length;
            const planned = projects.filter(p => p.status === 'Planned' || !p.status).length;
            const categories = [...new Set(projects.map(p => p.category))].length;

            // Update counters
            document.getElementById('total-projects').setAttribute('data-target', total);
            document.getElementById('completed-count').setAttribute('data-target', completed);
            document.getElementById('in-progress-count').setAttribute('data-target', inProgress);
            document.getElementById('categories-count').setAttribute('data-target', categories);

            // Initialize counter animations AFTER setting data-target
            ProjectDock.Counter.init();

            // Calculate percentages
            const completedPercent = total > 0 ? ((completed / total) * 100).toFixed(1) : 0;
            const inProgressPercent = total > 0 ? ((inProgress / total) * 100).toFixed(1) : 0;
            const plannedPercent = total > 0 ? ((planned / total) * 100).toFixed(1) : 0;

            // Update percentage displays
            document.getElementById('completed-percentage').textContent = completedPercent + '%';
            document.getElementById('in-progress-percentage').textContent = inProgressPercent + '%';
            document.getElementById('planned-percentage').textContent = plannedPercent + '%';

            // Animate progress bars
            setTimeout(() => {
                document.getElementById('completed-bar').style.width = completedPercent + '%';
                document.getElementById('in-progress-bar').style.width = inProgressPercent + '%';
                document.getElementById('planned-bar').style.width = plannedPercent + '%';
            }, 500);

            // Render charts
            renderStatusChart(completed, inProgress, planned);
            renderCategoryChart(projects);

            // Load recent projects
            loadRecentProjects(projects);
        }

        function renderStatusChart(completed, inProgress, planned) {
            const chartContainer = document.getElementById('status-chart');
            const total = completed + inProgress + planned;

            if (total === 0) {
                chartContainer.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 3rem;">No projects to display</p>';
                return;
            }

            const completedPercent = (completed / total) * 100;
            const inProgressPercent = (inProgress / total) * 100;
            const plannedPercent = (planned / total) * 100;

            chartContainer.innerHTML = `
                <div style="display: flex; flex-direction: column; gap: 1.5rem;">
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">Completed</span>
                            <span style="color: var(--text-light);">${completed} (${completedPercent.toFixed(1)}%)</span>
                        </div>
                        <div style="width: 100%; height: 30px; background: var(--border-color); border-radius: var(--radius-md); overflow: hidden; position: relative;">
                            <div style="width: ${completedPercent}%; height: 100%; background: linear-gradient(90deg, #48bb78, #38a169); transition: width 1s ease;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">In Progress</span>
                            <span style="color: var(--text-light);">${inProgress} (${inProgressPercent.toFixed(1)}%)</span>
                        </div>
                        <div style="width: 100%; height: 30px; background: var(--border-color); border-radius: var(--radius-md); overflow: hidden;">
                            <div style="width: ${inProgressPercent}%; height: 100%; background: linear-gradient(90deg, #4299e1, #3182ce); transition: width 1s ease;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">Planned</span>
                            <span style="color: var(--text-light);">${planned} (${plannedPercent.toFixed(1)}%)</span>
                        </div>
                        <div style="width: 100%; height: 30px; background: var(--border-color); border-radius: var(--radius-md); overflow: hidden;">
                            <div style="width: ${plannedPercent}%; height: 100%; background: linear-gradient(90deg, #ed8936, #dd6b20); transition: width 1s ease;"></div>
                        </div>
                    </div>
                </div>
            `;

            // Animate bars
            setTimeout(() => {
                chartContainer.querySelectorAll('div[style*="width:"]').forEach(bar => {
                    const width = bar.style.width;
                    bar.style.width = '0%';
                    setTimeout(() => {
                        bar.style.width = width;
                    }, 100);
                });
            }, 100);
        }

        function renderCategoryChart(projects) {
            const chartContainer = document.getElementById('category-chart');
            const categoryCounts = {};

            projects.forEach(project => {
                const category = project.category || 'Other';
                categoryCounts[category] = (categoryCounts[category] || 0) + 1;
            });

            const entries = Object.entries(categoryCounts).sort((a, b) => b[1] - a[1]);
            const total = projects.length;

            if (total === 0) {
                chartContainer.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 3rem;">No projects to display</p>';
                return;
            }

            chartContainer.innerHTML = entries.map(([category, count]) => {
                const percent = (count / total) * 100;
                return `
                    <div style="margin-bottom: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span style="font-weight: 600;">${category}</span>
                            <span style="color: var(--text-light);">${count} (${percent.toFixed(1)}%)</span>
                        </div>
                        <div style="width: 100%; height: 25px; background: var(--border-color); border-radius: var(--radius-md); overflow: hidden;">
                            <div style="width: ${percent}%; height: 100%; background: linear-gradient(135deg, var(--primary-gradient-start), var(--primary-gradient-end)); transition: width 1s ease;"></div>
                        </div>
                    </div>
                `;
            }).join('');

            // Animate bars
            setTimeout(() => {
                chartContainer.querySelectorAll('div[style*="width:"]').forEach(bar => {
                    const width = bar.style.width;
                    bar.style.width = '0%';
                    setTimeout(() => {
                        bar.style.width = width;
                    }, 100);
                });
            }, 100);
        }

        function loadRecentProjects(projects) {
            const recentContainer = document.getElementById('recent-projects-list');
            const recentProjects = projects
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);

            if (recentProjects.length === 0) {
                recentContainer.innerHTML = '<p style="text-align: center; color: var(--text-light); padding: 2rem;">No projects yet. <a href="add-project.html" style="color: var(--accent-color);">Create your first project!</a></p>';
                return;
            }

            recentContainer.innerHTML = recentProjects.map(project => `
                <div style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; border-bottom: 1px solid var(--border-color); transition: background var(--transition-fast); cursor: pointer;"
                     onclick="window.location.href='project-detail.html?id=${project.id}'"
                     onmouseover="this.style.background='var(--bg-primary)'"
                     onmouseout="this.style.background='transparent'">
                    <div style="flex: 1;">
                        <h4 style="margin-bottom: 0.25rem;">${project.name}</h4>
                        <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                            <span style="font-size: 0.875rem; color: var(--text-light);">${project.category || 'Uncategorized'}</span>
                            <span style="font-size: 0.875rem; color: var(--text-light);">â€¢</span>
                            <span style="font-size: 0.875rem; color: var(--text-light);">${new Date(project.createdAt).toLocaleDateString()}</span>
                        </div>
                    </div>
                    <div>
                        <span style="padding: 0.25rem 0.75rem; background: ${getStatusColor(project.status)}; color: white; border-radius: var(--radius-sm); font-size: 0.85rem;">
                            ${project.status || 'Planned'}
                        </span>
                    </div>
                </div>
            `).join('');
        }

        function getStatusColor(status) {
            const colors = {
                'Completed': '#48bb78',
                'In Progress': '#4299e1',
                'Planned': '#ed8936',
                'On Hold': '#a0aec0'
            };
            return colors[status] || '#a0aec0';
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadDashboard();
            ProjectDock.ScrollAnimations.init();
        });
    </script>
</body>
</html>

